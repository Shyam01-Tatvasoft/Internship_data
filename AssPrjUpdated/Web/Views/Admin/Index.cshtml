@model Repository.ViewModels.AdminPageViewModel;
@{
    ViewData["Title"] = "Index";
}
<div class="text-center">
    <h1>Concert Management system</h1>
</div>
<div class="text-center">
    <button class="btn btn-secondary" id="AddConcert">Add Concert</button>
</div>
<div id="concertListContainer" class="container-fluid mt-4 overflow-auto" style="max-height:76vh;">
    <partial name="_ConcertList" model="Model" />
</div>

<div id="AddEditConcertContainer">
</div>


<div class="modal fade" id="deleteConcertModal" tabindex="-1" aria-labelledby="exampleModalLabel" >
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content ">
            <div class="modal-header border-0">
                <h1 class="modal-title fs-5" id="exampleModalLabel">Delete Confirmation</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="text-center">
                <i class="fa-solid fa-triangle-exclamation fa-2xl" style="color: #FFD43B;"></i>
            </div>
            <div class="modal-body text-center p-1">
                <p class="fw-bold mb-0">Are you sure you want to delete this Table?</p>
            </div>
            <div class="modal-footer d-flex justify-content-center border-0">
                <button type="button" class="btn btn-primary" id="confirmDeleteTableBtn">Yes</button>
                <button type="button" class="btn btn-outline-primary" data-bs-dismiss="modal">No</button>
            </div>
        </div>
    </div>
</div>

<script>
    $("#AddConcert").click(function(){
       console.log("Employe")
        $.ajax({
            url: '/Admin/AddEditConcert',
            type: 'GET',
            data:{id:null},
            success: function(Response){
                $("#AddEditConcertContainer").html(Response);
                $("#AddEditConcertModal").modal('show');
            },
            error: function(error){
                toastr.error(error.message);
            }
        })
    })

      var deleteId;
    $(document).on('click','.deleteConcert',function(){
        deleteId = $(this).data('id');
        $("#deleteConcertModal").modal('show');
        console.log(deleteId);
    })


      async function GetFilterConcerts() {
            $.ajax({
                url: "/Admin/GetConcerts",
                type: "GET",
                data: {
                    searchString: null,
                    artistName: null,
                    startDate:null,
                    endDate:null,
                    venueType:null,
                    venueBy:null,
                },
                success: function (data) {
                    $("#concertListContainer").html(data);
                },
                error:function(error){
                    console.log(err)
                }
            })
        }
    $("#confirmDeleteTableBtn").click(function(){
        $.ajax({
            url: '/Admin/DeleteConcert',
            type: 'POST',
            data: {id:deleteId},
            success: function (response) {
                if (response.success) {
                    toastr.success(response.message);
                    $("#deleteConcertModal").modal('hide');
                     GetFilterConcerts();
                }
                else {
                    toastr.error(response.message);
                    return;
                }
            },
            error: function (error) {
                toastr.error(error.message)
            }
        })
    })

     $(document).on('click','.editConcert',function(){
       var id = $(this).data('id');
        console.log(id);
        $.ajax({
            url: '/Admin/AddEditConcert',
            type: 'GET',
            data:{id:id},
            success: function(Response){
                $("#AddEditConcertContainer").html(Response);
                $("#AddEditConcertModal").modal('show');
            },
            error: function(error){
                toastr.error(error.message);
            }
        })
    })
</script>
